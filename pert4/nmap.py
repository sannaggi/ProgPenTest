from socket import socket
from threading import Thread

HOST = "localhost"

def main():
    threads = []
    
    for x in range(75, 300):
        t = Thread(target=process, args=(x,))
        threads.append(t)
        t.start()

    for t in threads:
        if t.is_alive():
            t.join()

def process(port):
    global HOST

    s = socket()
    s.settimeout(5)
    res = s.connect_ex((HOST, port))
    if res == 0:
        print("{} open".format(port)) # Port 135 is a basic communications port for Windows DCOM and needs to be open to your LAN for server to work.
    else:
        print("{} {} closed".format(port, res))

if __name__ == "__main__":
    main()